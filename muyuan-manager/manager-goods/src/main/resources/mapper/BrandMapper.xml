<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.muyuan.manager.goods.base.persistence.mapper.BrandMapper">

    <resultMap type="com.muyuan.manager.goods.model.Brand" id="BrandResult">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="logo" column="logo"/>
        <result property="orderNum" column="orderNum"/>
        <result property="englishName" column="english_name"/>
        <result property="status" column="status"/>
        <result property="remark" column="remark"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="createBy" column="create_by"/>
        <result property="updater" column="updater"/>
        <result property="creator" column="creator"/>
        <result property="auditStatus" column="audit_status"/>
    </resultMap>

    <sql id="selectBrandVo">
        select id,
               name,
               logo,
               order_num,
               english_name,
               product_count,
               status,
               remark,
               create_time,
               update_time,
               update_by,
               create_by,
               updater,
               creator,
               audit_status
        from t_brand
    </sql>


    <select id="selectBy" resultType="com.muyuan.manager.goods.model.Brand" parameterType="com.muyuan.manager.goods.dto.BrandParams">
        select brand.*
        from (
                 select *
                 from t_brand
                <where>
                     del = '1'
                    <if test="id != null" >
                        and id = #{id}
                    </if>
                    <if test="name != null and name != ''">
                        and name like #{name}||'%'
                    </if>
                    <if test="auditStatus != null">
                        and audit_status = #{auditStauts}
                    </if>
                </where>
             ) brand
                 inner join (
            select brand_id
            from t_brand_category
            <where>
                <if test="categoryCode != null" >
                    and category_code = #{categoryCode}
                </if>
            </where>
        ) t on id = brand_id;
    </select>


</mapper>